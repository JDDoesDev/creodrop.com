---
import { getCollection } from 'astro:content';
import PageLayout from '../../layouts/PageLayout.astro';

const posts = await getCollection('blog', ({ data }) => !data.draft);
const sortedPosts = posts.sort(
  (a, b) => b.data.publishDate.valueOf() - a.data.publishDate.valueOf()
);
---

<PageLayout
  title="Blog - Creodrop"
  description="Insights on Drupal hosting, web development, and building scalable websites."
  canonical="https://creodrop.com/blog/"
  ogTitle="Creodrop Blog"
  ogDescription="Insights on Drupal hosting, web development, and building scalable websites."
>
  <section class="blog-hero">
    <div class="container">
      <h1 class="blog-hero-title">Blog</h1>
      <p class="blog-hero-subtitle">
        Insights on Drupal, web development, and building scalable websites.
      </p>
    </div>
  </section>

  <section class="blog-list">
    <div class="container">
      {
        sortedPosts.length > 0 ? (
          <div class="blog-grid">
            {sortedPosts.map((post) => (
              <article class="blog-card">
                <h2 class="blog-card-title">
                  <a href={`/blog/${post.slug}/`}>{post.data.title}</a>
                </h2>
                <time
                  class="blog-card-date"
                  datetime={post.data.publishDate.toISOString()}
                >
                  {post.data.publishDate.toLocaleDateString('en-US', {
                    year: 'numeric',
                    month: 'long',
                    day: 'numeric',
                  })}
                </time>
                <p class="blog-card-description">{post.data.description}</p>
                <a href={`/blog/${post.slug}/`} class="blog-card-link">
                  Read more â†’
                </a>
              </article>
            ))}
          </div>
        ) : (
          <div class="blog-empty">
            <p>No posts yet. Check back soon!</p>
          </div>
        )
      }
    </div>
  </section>
</PageLayout>
